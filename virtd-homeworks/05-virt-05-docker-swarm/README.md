# Домашнее задание к занятию 5. «Оркестрация кластером Docker контейнеров на примере Docker Swarm»

## Задача 1

Дайте письменые ответы на вопросы:

- В чём отличие режимов работы сервисов в Docker Swarm-кластере: replication и global?

В режиме replication приложение запускается в том количестве экземпляров, какое укажет пользователь.
При этом на отдельной node может быть как несколько экземпляров приложения, так и не быть совсем.
В режиме global приложение запускается обязательно на каждой node и в единственном экземпляре.

- Какой алгоритм выбора лидера используется в Docker Swarm-кластере?

В Docker Swarm кластере используется так называемый алгоритм поддержания распределенного консенсуса - Raft.

Протокол решает проблему согласованности - чтобы все manager-ноды имели одинаковое представление
о состоянии кластера
Для отказоустойчивой работы лучше чтобы было не менее 3 manager-нод.
Среди manager-нод выбирается лидер, его задача гарантировать согласованность.
Лидер отправляет keepalive-пакеты с заданной периодичностью в пределах 150-300мс.
Если пакеты не пришли, менеджеры начинают выборы нового лидера.

- Что такое Overlay Network?

Overlay network - это внутренняя виртуальная сеть кластера docker swarm, которая упрощает взаимодействие узлов кластера между собой.

## Задача 2

Создайте ваш первый Docker Swarm-кластер в Яндекс Облаке.

Чтобы получить зачёт, предоставьте скриншот из терминала (консоли) с выводом команды:
```
docker node ls
```
![alt text](https://github.com/andrewchikin/devops-netology/blob/5e40653310389c0640e84bff8b4f3b99b755e4ea/virtd-homeworks/05-virt-05-docker-swarm/%D0%97%D0%B0%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5%202.png)

## Задача 3

Создайте ваш первый, готовый к боевой эксплуатации кластер мониторинга, состоящий из стека микросервисов.

Чтобы получить зачёт, предоставьте скриншот из терминала (консоли), с выводом команды:
```
docker service ls
```
![alt text](https://github.com/andrewchikin/devops-netology/blob/5e40653310389c0640e84bff8b4f3b99b755e4ea/virtd-homeworks/05-virt-05-docker-swarm/%D0%97%D0%B0%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5%203.png)

## Задача 4 (*)

Выполните на лидере Docker Swarm-кластера команду, указанную ниже, и дайте письменное описание её функционала — что она делает и зачем нужна:
```
# см.документацию: https://docs.docker.com/engine/swarm/swarm_manager_locking/
docker swarm update --autolock=true
```
–autolock=true обязывает вводить ключ разблокировки на ноде, чтобы она могла заново присоединиться к кластеру,
если была перезапущена.
![alt text](https://github.com/andrewchikin/devops-netology/blob/5e40653310389c0640e84bff8b4f3b99b755e4ea/virtd-homeworks/05-virt-05-docker-swarm/%D0%97%D0%B0%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5%204.png)


